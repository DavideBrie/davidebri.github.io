<p>nmap is a pentesting tool executed via terminal using <code class="language-plaintext highlighter-rouge">nmap</code> command.</p>

<p>It’s usefull for <strong>port scanning</strong>, that means we know if that computer is hosting some Website or open to SSH etc. A port is necessary for making request on a network.</p>

<p>Every computer has a total of 65535 available ports; however, many of these are registered as standard ports (1024).</p>

<p>So nmap does a check on every port and depending on how the port responds, it can be determined as being open, closed, or filtered (usually by a firewall).</p>

<h1 id="scan-types">Scan types</h1>

<p>When port scanning with Nmap, there are three basic scan types. These are:</p>

<ol>
  <li><strong>TCP Connect Scans (<code class="language-plaintext highlighter-rouge">-sT</code>)</strong></li>
</ol>

<p>This perform a three-way handshake with the ports specified in the command. Depends on what we get back, we can figure it out how’s the port’s status. <br />
If we get back a <code class="language-plaintext highlighter-rouge">RST</code> flag set -&gt; the port is <strong>close</strong>; <br />
If we get back a <code class="language-plaintext highlighter-rouge">SYN/ACK</code> flag set -&gt; the port is <strong>open</strong>; <br />
What if we got nothing back? This mean that the port is hidden behind a firewall and it will be marked as <strong>filtered</strong>;</p>

<ol>
  <li><strong>SYN Scans (<code class="language-plaintext highlighter-rouge">-sS</code>)</strong></li>
</ol>

<p>Also known as <em>stealth</em> scan, is used to scan the TCP port-range of a prey(s).
Keep in mind that this scan require sudo permission, because we need to create raw packets not the full TCP handshake.</p>

<ol>
  <li><strong>UDP Scans (<code class="language-plaintext highlighter-rouge">-sU</code>)</strong></li>
</ol>

<p>When a packet is sent to an open UDP port, there should be no response. When this happens, nmap refers to the port as being <strong>open</strong> or <strong>filtered</strong></p>

<p><br /></p>

<p>Additionally there are several less common port scan types like:</p>

<ol>
  <li><strong>TCP Null Scans (<code class="language-plaintext highlighter-rouge">-sN</code>)</strong></li>
</ol>

<p>Send TCP request is sent with no flags set at all, and if it’s closed it should send back the <code class="language-plaintext highlighter-rouge">RST</code> flag.</p>

<ol>
  <li><strong>TCP FIN Scans (<code class="language-plaintext highlighter-rouge">-sF</code>)</strong></li>
</ol>

<p>The request is sent with only the <code class="language-plaintext highlighter-rouge">FIN</code>  flag. Once again, nmap expects a RST if the port is closed.</p>

<ol>
  <li><strong>TCP Xmas Scans (<code class="language-plaintext highlighter-rouge">-sX</code>)</strong></li>
</ol>

<p>Send a malformed TCP packet, with only <code class="language-plaintext highlighter-rouge">PSH</code>, <code class="language-plaintext highlighter-rouge">URG</code> and <code class="language-plaintext highlighter-rouge">FIN</code> sets and expects a RST response for closed ports.</p>

<h1 id="nmap-scripting-engine---nse">Nmap Scripting Engine - NSE</h1>

<p>This scripts, written in <a href="https://en.wikipedia.org/wiki/Lua_(programming_language)">LUA</a>, expands the nmap capability.
The standard scripts, stored at <code class="language-plaintext highlighter-rouge">/usr/share/nmap/scripts</code>,  are divded by categorys such as: <strong>safe</strong>, <strong>intrusive</strong>, <strong>vuln</strong>, <strong>exploit</strong>, <strong>auth</strong>, <strong>brute</strong> and <em>[many more]</em>(https://nmap.org/book/nse-usage.html).</p>

<p>It’s possible to use this scripts typing:</p>

<p><code class="language-plaintext highlighter-rouge">nmap &lt;IP_ADDRESS&gt; -sT -sS --script=&lt;CATEGORY&gt;</code></p>

<p>and, if needed, it possible to parse some arguments to them with <code class="language-plaintext highlighter-rouge">--script-args</code> followed by the arguments.</p>

